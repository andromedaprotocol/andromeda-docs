---
description: The GraphQL queries that can be performed on the CW721 ADO.
---

# CW721

### queryAllNFTInfo

Queries all stored info of the specified token.

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#allnftinfo).
{% endhint %}

```typescript
export async function queryAllNFTInfo(
  contractAddress: string,
  tokenId: string,
  includeExpired: boolean = false
): Promise<QueryCW721AllNFTInfoResponse["allNftInfo"]> {
  const resp = await query<QueryCW721AllNFTInfo, QueryCW721AllNFTInfoResponse>(
    QUERY_CW721_ALL_NFT_INFO,
    { contractAddress, tokenId, includeExpired }
  );

  return resp.allNftInfo;
}
```

| Name              | Type    | Description                                                 |
| ----------------- | ------- | ----------------------------------------------------------- |
| `contractAddress` | string  | The contract address of the cw721 contract to query.        |
| `tokenId`         | string  | The Id of the token/NFT to query info about.                |
| `includeExpired`  | boolean | Whether to include expired approvals or not. Set to false.  |

#### Response

```typescript
export interface QueryCW721AllNFTInfoResponse {
  allNftInfo: {
    access: NFTOwnerInfo;
    info: NFTInfo;
  };
}
```

| Name     | Type                               | Description                                                |
| -------- | ---------------------------------- | ---------------------------------------------------------- |
| `access` | [NFTOwnerInfo](cw721.md#undefined) | Information on the owner and aproved operators of the NFT. |
| `info`   | [NFTInfo](cw721.md#undefined)      | Information on the NFT itself.                             |

#### NFTOwnerInfo

```typescript
export interface NFTOwnerInfo {
  approvals: NFTApproval[];
  owner: string;
}
```

| Name        | Type                              | Description                                      |
| ----------- | --------------------------------- | ------------------------------------------------ |
| `approvals` | [NFTApproval](cw721.md#undefined) | Vector of the given approvals for the token/NFT. |
| `owner`     | string                            | The address of the token/NFT owner.T             |

#### NFTApproval

```typescript
export interface NFTApproval {
  expires: Expiry;
  spender: string;
}
```

| Name      | Type                | Description              |
| --------- | ------------------- | ------------------------ |
| `expires` | [Expiry](./#expiry) | Expiry for the approval. |
| `spender` | string              | The approved address.    |

#### NFTInfo

```typescript
export interface NFTInfo {
  extension: NFTExtension;
  tokenUri: string;
}
```

| Name        | Type                               | Description                            |
| ----------- | ---------------------------------- | -------------------------------------- |
| `extension` | [NFTExtension](cw721.md#undefined) | Additioinal information about the NFT. |
| `tokenUri`  | string                             | The token URI.                         |

#### NFTExtension

```typescript
export interface NFTExtension {
  name: string;
  publisher: string;
  description?: string;
  attributes: NFTAttribute[];
  image: string;
  image_data?: string;
  external_url?: string;
  animation_url?: string;
  youtube_url?: string;
}
```

| Name             | Type            | Description                             |
| ---------------- | --------------- | --------------------------------------- |
| `name`           | string          | The name of the token.                  |
| `publisher`      | string          | The original publisher of the token.    |
| `description?`   | string          | An optional description of the token.   |
| `attributes`     | NFTAttribute\[] | The metadata of the token if it exists. |
| `image`          | string          | URL to the token image.                 |
| `image_data?`    | string          | Raw SVG image data                      |
| `external_url?`  | string          | A URL to the token's source.            |
| `animation_url?` | string          | A URL to any multi-media attachments.   |
| `youtube_url?`   | string          | A URL to a related Youtube video.       |

#### NFTAttribute

```typescript
export interface NFTAttribute {
  trait_type: string;
  value: string;
  display_type?: string;
}
```

| Name            | Type   | Description                               |
| --------------- | ------ | ----------------------------------------- |
| `trait_type`    | string | The key for the attribute.                |
| `value`         | string | The value for the attribute               |
| `display_type`? | string | The string used to display the attribute. |

### queryAllOperators

Queries any operators for a given address.

{% hint style="info" %}
The contract query can be found [here.](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#alloperators)
{% endhint %}

```typescript
export async function queryAllOperators(
  contractAddress: string,
  owner: string,
  includeExpired: boolean = false,
  options?: AndrSearchOptions
): Promise<QueryCW721AllOperatorsResponse["allOperators"]> {
  const resp = await query<
    QueryCW721AllOperators,
    QueryCW721AllOperatorsResponse
  >(QUERY_CW721_ALL_OPERATORS, {
    contractAddress,
    includeExpired,
    owner,
    options,
  });

  return resp.allOperators;
}
```

| Name              | Type    | Description                                              |
| ----------------- | ------- | -------------------------------------------------------- |
| `contractAddress` | string  | The contract address of the  cw721 contract to query.    |
| `owner`           | string  | The address to check approvals for.                      |
| `includeExpired`  | boolean | Whether expired approvals should be shown. Set to false. |

#### Response

```typescript
export interface QueryCW721AllOperatorsResponse {
  allOperators: NFTApproval[];
}
```

| Name           | Type                                   | Description                                   |
| -------------- | -------------------------------------- | --------------------------------------------- |
| `allOperators` | [NFTApproval](cw721.md#nftapproval)\[] | The operators of the specified owner address. |

#### NFTApproval

```typescript
export interface NFTApproval {
  expires: Expiry;
  spender: string;
}
```

| Name      | Type                | Description                           |
| --------- | ------------------- | ------------------------------------- |
| `expires` | [Expiry](./#expiry) | The expiration of the approval.       |
| `spender` | string              | The address of the approved operator. |

### queryApproval

Queries the spender's approval to check for the expiration.

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#approval).&#x20;
{% endhint %}

```typescript
export async function queryApproval(
  contractAddress: string,
  spender: string,
  tokenId: string,
  includeExpired: boolean = false
): Promise<QueryCW721ApprovalResponse["approval"]> {
  const resp = await query<QueryCW721Approval, QueryCW721ApprovalResponse>(
    QUERY_CW721_APPROVAL,
    { contractAddress, spender, tokenId, includeExpired }
  );

  return resp.approval;
}
```

| Name              | Type    | Description                                                   |
| ----------------- | ------- | ------------------------------------------------------------- |
| `contractAddress` | string  | The contract address of the  cw721 contract to query.         |
| `spender`         | string  | The address to check for the approval.                        |
| `tokenId`         | string  | The id of the token/NFT to check approval for.                |
| `includeExpired`  | boolean | Whether to include expired an expired approval. Set to false. |

#### Response

```typescript
export interface QueryCW721ApprovalResponse {
  approval: NFTApproval;
}
```

| Name       | Type                                | Description                            |
| ---------- | ----------------------------------- | -------------------------------------- |
| `approval` | [NFTApproval](cw721.md#nftapproval) | The approval information if it exists. |

### queryApprovals

Queries all the approvals a token has.

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#approvals).
{% endhint %}

```typescript
export async function queryApprovals(
  contractAddress: string,
  tokenId: string,
  includeExpired: boolean = false
): Promise<QueryCW721ApprovalsResponse["approvals"]> {
  const resp = await query<QueryCW721Approvals, QueryCW721ApprovalsResponse>(
    QUERY_CW721_APPROVALS,
    { contractAddress, tokenId, includeExpired }
  );

  return resp.approvals;
}
```

| Name              | Type    | Description                                           |
| ----------------- | ------- | ----------------------------------------------------- |
| `contractAddress` | string  | The contract address of the  cw721 contract to query. |
| `tokenId`         | string  | The id of the token/NFT.                              |
| `includeExpired`  | boolean | Whether to include expired approvals. Set to false.   |

#### Response

```typescript
export interface QueryCW721ApprovalsResponse {
  approvals: NFTApproval[];
}
```

| Name        | Type                                   | Description                                                                   |
| ----------- | -------------------------------------- | ----------------------------------------------------------------------------- |
| `approvals` | [NFTApproval](cw721.md#nftapproval)\[] | A vector of NFTApproval containing all the approvals for the specified token. |

### queyContractInfo

Queries the  name and symbol of  the token collection.

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#contractinfo).

This query also provides the number of tokens which is the [NumTokens query.](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#numtokens)
{% endhint %}

```typescript
export async function queryContractInfo(
  contractAddress: string
): Promise<QueryCW721ContractInfoResponse["contractInfo"]> {
  const resp = await query<
    QueryCW721ContractInfo,
    QueryCW721ContractInfoResponse
  >(QUERY_CW721_CONTRACT_INFO, { contractAddress });

  return resp.contractInfo;
}
```

| Name              | Type   | Description                                                   |
| ----------------- | ------ | ------------------------------------------------------------- |
| `contractAddress` | string | The contract address of the  cw721 contract to query info on. |

#### Response

```typescript
export interface QueryCW721ContractInfoResponse {
  contractInfo: NFTContractInfo;
  minter: string;
  numTokens: number;
}
```

| Name           | Type                                  | Description                                   |
| -------------- | ------------------------------------- | --------------------------------------------- |
| `contractInfo` | [NFTContractInfo](cw721.md#undefined) | Information on the contract.                  |
| `minter`       | string                                | The address of the minter.                    |
| `numTokens`    | string                                | The number of tokens minted by the contract.  |

#### NFTContractInfo

```typescript
export interface NFTContractInfo {
  name: string;
  symbol: string;
}
```

| Name     | Type   | Description                       |
| -------- | ------ | --------------------------------- |
| `name`   | string | The name of the NFT collection.   |
| `symbol` | string | The symbol of the NFT collection. |

### queryIsArchived

Queries whether the specified token is archived or not.

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#isarchived).
{% endhint %}

```typescript
export async function queryIsArchived(
  contractAddress: string,
  tokenId: string
): Promise<QueryCW721IsArchivedResponse["isArchived"]> {
  const resp = await query<QueryCW721IsArchived, QueryCW721IsArchivedResponse>(
    QUERY_CW721_IS_ARCHIVED,
    { contractAddress, tokenId }
  );

  return resp.isArchived;
}
```

| Name              | Type   | Description                                                                     |
| ----------------- | ------ | ------------------------------------------------------------------------------- |
| `contractAddress` | string | The contract address of the  cw721 contract that has minted the token to query. |
| `tokenId`         | string | The Id of the token/NFT.                                                        |

#### Response

```typescript
export interface QueryCW721IsArchivedResponse {
  isArchived: boolean;
}
```

| Name         | Type    | Description                          |
| ------------ | ------- | ------------------------------------ |
| `isArchived` | boolean | Whether the token is achived or not. |

### queryNFTInfo

Queries information on the specified token

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#nftinfo).
{% endhint %}

```typescript
export async function queryNFTInfo(
  contractAddress: string,
  tokenId: string
): Promise<QueryCW721NftInfoResponse["nftInfo"]> {
  const resp = await query<QueryCW721NFTInfo, QueryCW721NftInfoResponse>(
    QUERY_CW721_NFT_INFO,
    { contractAddress, tokenId }
  );

  return resp.nftInfo;
}
```

| Name              | Type   | Description                                                                     |
| ----------------- | ------ | ------------------------------------------------------------------------------- |
| `contractAddress` | string | The contract address of the  cw721 contract that has minted the token to query. |
| `tokenId`         | string | The Id of the token/NFT.                                                        |

#### Response

```typescript
export interface QueryCW721NftInfoResponse {
  nftInfo: NFTInfo;
}
```

| Name      | Type                        | Description                              |
| --------- | --------------------------- | ---------------------------------------- |
| `nftInfo` | [NFTInfo](cw721.md#nftinfo) | Information on the specified  token/NFT. |

### queryOwnerOf

Queries the owner of the specified token

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#ownerof).
{% endhint %}

```typescript
export async function queryOwnerOf(
  contractAddress: string,
  tokenId: string
): Promise<string> {
  const resp = await query<QueryCW721OwnerOf, QueryCW721OwnerOfResponse>(
    QUERY_CW721_OWNER_OF,
    { contractAddress, tokenId }
  );

  return resp.ownerOf.owner;
}
```

| Name              | Type   | Description                                                                     |
| ----------------- | ------ | ------------------------------------------------------------------------------- |
| `contractAddress` | string | The contract address of the  cw721 contract that has minted the token to query. |
| `tokenId`         | string | The Id of the token/NFT.                                                        |

#### Response

```typescript
export interface QueryCW721OwnerOfResponse {
  ownerOf: {
   owner: string 
   };
}
```

| Name    | Type   | Description                         |
| ------- | ------ | ----------------------------------- |
| `owner` | string | The address of the token/NFT owner. |

### queryTokens

Queries all the tokens of the specified owner.

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#tokens).
{% endhint %}

```typescript
export async function queryTokens(
  contractAddress: string,
  owner: string,
  options?: AndrSearchOptions
): Promise<QueryCW721TokensResponse["tokens"]> {
  const resp = await query<QueryCW721Tokens, QueryCW721TokensResponse>(
    QUERY_CW721_TOKENS,
    { contractAddress, owner, options }
  );

  return resp.tokens;
}
```

| Name              | Type                                      | Description                                                            |
| ----------------- | ----------------------------------------- | ---------------------------------------------------------------------- |
| `contractAddress` | string                                    | The contract address of the  cw721 contract to query.                  |
| `owner`           | string                                    | The address to query the tokens for.                                   |
| `options?`        | [AndrSearchOptions](./#andrsearchoptions) | Optional additional options for the query. Mostly used for pagination. |

#### Response

```typescript
export interface QueryCW721TokensResponse {
  tokens: string[];
}
```

| Name     | Type      | Description                                                                |
| -------- | --------- | -------------------------------------------------------------------------- |
| `tokens` | string\[] | A vector of string containing the token Ids that the specified owner owns. |

### queryTransferAgreement

Query the TransferAgreement of a token if it exists.

{% hint style="info" %}
Contract query can be found [here](../../../smart-contracts/non-fungible-tokens/andromeda-digital-object.md#transferagreement-2).
{% endhint %}

```typescript
export async function queryTransferAgreement(
  contractAddress: string,
  tokenId: string
): Promise<TransferAgreement> {
  const resp = await query<
    QueryCW721TransferAgreement,
    QueryCW721TransferAgreementResponse
  >(QUERY_CW721_TRANSFER_AGREEMENT, { contractAddress, tokenId });

  return resp.transferAgreement;
}
```

| Name              | Type   | Description                                           |
| ----------------- | ------ | ----------------------------------------------------- |
| `contractAddress` | string | The contract address of the  cw721 contract to query. |
| `tokenId`         | string | The Id of the token/NFT.                              |

#### Response

```typescript
export interface QueryCW721TransferAgreementResponse {
  transferAgreement: TransferAgreement;
}
```

Returns a TransferAgreement if found.

#### TransferAgreement

```typescript
export interface TransferAgreement {
  tokenId: string;
  agreement: Agreement;
}
```

| Name        | Type                            | Description                            |
| ----------- | ------------------------------- | -------------------------------------- |
| `tokenId`   | string                          | The Id of the token/NFT.               |
| `agreement` | [Agreement](cw721.md#undefined) | Information on the transfer agreement. |

#### Agreement

```typescript
export interface Agreement {
  amount: { raw: Coin };
  purchaser: string;
}
```

| Name        | Type                      | Description                                                               |
| ----------- | ------------------------- | ------------------------------------------------------------------------- |
| raw         | [Coin](crowdfund.md#coin) | The amount required for the purchaser to transfer ownership of the token. |
| `purchaser` | string                    | The address of the token purchaser in the agreement.                      |
